<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.prize.lottery.infrast.persist.mapper.ChargeConfMapper">

    <resultMap id="ChargeConfMap" type="com.prize.lottery.infrast.persist.po.ChargeConfPo">
        <id column="id" property="id"/>
        <result column="name" property="name"/>
        <result column="amount" property="amount"/>
        <result column="gift" property="gift"/>
        <result column="priority" property="priority"/>
        <result column="state" property="state"/>
        <result column="version" property="version"/>
        <result column="gmt_create" property="gmtCreate"/>
        <result column="gmt_modify" property="gmtModify"/>
    </resultMap>

    <insert id="addChargeConf" parameterType="com.prize.lottery.infrast.persist.po.ChargeConfPo">
        insert into charge_config(id,
        name,
        amount,
        gift,
        <if test="priority!=null">
            priority,
        </if>
        state,
        version,
        gmt_create,
        gmt_modify
        )
        values (#{id},
        #{name},
        #{amount},
        #{gift},
        <if test="priority!=null">
            #{priority},
        </if>
        #{state},
        1,
        current_time,
        current_time
        )
    </insert>

    <update id="editChargeConf" parameterType="com.prize.lottery.infrast.persist.po.ChargeConfPo">
        update charge_config
        set
        <if test="name!=null">
            name=#{name},
        </if>
        <if test="amount!=null">
            amount=#{amount},
        </if>
        <if test="priority!=null">
            priority=#{priority},
        </if>
        <if test="gift!=null">
            gift=#{gift},
        </if>
        <if test="state!=null">
            state=#{state},
        </if>
        version=version + 1,
        gmt_modify=current_time
        where
        id = #{id}
    </update>

    <delete id="removeInvalidConf">
        delete
        from
            charge_config
        where
            state = 0
    </delete>

    <select id="getChargeConf" parameterType="java.lang.Long" resultMap="ChargeConfMap">
        select
            id,
            name,
            amount,
            gift,
            priority,
            state,
            version,
            gmt_create
        from
            charge_config
        where
            id = #{id}
    </select>

    <select id="getAllConfigList" resultMap="ChargeConfMap">
        select
        id,
        name,
        amount,
        gift,
        priority,
        state,
        version,
        gmt_create,
        gmt_modify
        from
        charge_config
        <where>
            <if test="state!=null">
                state=#{state}
            </if>
        </where>
    </select>

</mapper>